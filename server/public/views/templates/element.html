<main>

    <h3>Form</h3>
    <button ng-click="vm.insertSection(0)">Add Section Here</button>
    <div ng-repeat="item in vm.newElement">
        <textarea ng-model="item.value"></textarea>
        <button ng-click="vm.removeSection($index)">Remove This Section</button>
        <br>
        <button ng-click="vm.insertSection($index+1)">Add Section Here</button>
    </div>
    <button ng-click="vm.saveElement(vm.newElement)">Save</button>

        <!-- <select>
            <option ng-repeat="element in vm.elementsList" value="{{element._id}}">{{element.content}}</option>
        </select> -->

        <select ng-init="vm.selectedType = vm.types[0]" ng-model="vm.selectedType" ng-options="type for type in vm.types"></select>

    <h3>Element</h3>

        <section ng-init="editableAny = true">

            <div id="options">
                <button ng-click="vm.updateElement(vm.element.element[0])">Save Changes</button>
                <label style="clear: both"><input type="checkbox" ng-model="editableAny" ng-init="editableHere = true" /> Enable Editing?</label>
            </div>

            <!-- TYPE: STRING -->
            <div ng-if="vm.element.element[0].type === 'string'">

                <!-- content pane -->
                <article ng-bind-html="vm.element.element[0].content | markdown"></article>

                <!-- edit pane -->

                    <!-- edit pane -->
                    <div style="float: right; width: 150px;">
                            <label ng-show="editableAny"><input type="checkbox" ng-model="editableHere" /> Edit</label>
                            <button ng-click="vm.removeSectionFromElement($index)">Remove</button>
    
                            <!-- FIX THIS NEXT -->
                            <!-- <button ng-click="vm.insertSectionInElement($index + 1)">Insert Section After This</button>
                            <div ng-show="editableHere">
                                <button ng-click="vm.explodeSelection($index + 1)">Explode Selection</button>
                                <textarea ng-model="section.value"></textarea>
                            </div> -->
                        </div> 
            </div>

            <!-- TYPE: DOCUMENT -->
            <div ng-if="vm.element.element[0].type === 'document'">
                <article><button ng-click="vm.insertSectionInElement(0)">Insert Section Here</button></article>

                
                <article style="clear: both; border: 1px #000 solid; margin: 10px 0; padding: 10px 0;" ng-repeat="section in vm.element.element[0].content" ng-init="editableHere = false">

                        <!-- var result = jsObjects.filter(function( obj ) {
                            return obj.b == 6;
                          }); -->
                    <!-- if the section is not a string stored in the element's content array -->


                    <div ng-if="section.type === 'external' && true">
                        <!--FIX THIS -->
                        {{section.src}}<br>asdfasdf<br>
                        <h1>asdf</h1>{{vm.element.references}}<br><br>
                        <div ng-repeat="vm.element.references"></div>
                        <br>answer:<br>{{vm.referenceLookup(vm.element.references, section.src, $index)}}
                        <div ng-repeat="item in vm.referenceLookup(vm.element.references, section.src, $index)">{{item}}</div>
                    </div>

                    <!-- If the section is a string stored in the element's content array -->
                    <div ng-if="!section.type">
                        
                        <!-- content pane -->
                        <div style="float: left; width: 400px;">
                            <div ng-bind-html="section.value | markdown"></div>
                        </div>

                        <!-- edit pane -->
                        <div style="float: right; width: 150px;">
                            <label ng-show="editableAny"><input type="checkbox" ng-model="editableHere" /> Edit</label>
                            <button ng-click="vm.removeSectionFromElement($index)">Remove</button>

                            <button ng-click="vm.insertSectionInElement($index + 1)">Insert Section After This</button>
                            <div ng-show="editableHere">
                                <button ng-click="vm.explodeSelection($index + 1)">Explode Selection</button>
                                <textarea ng-model="section.value"></textarea>
                            </div>
                        </div> 

                    </div>

                </article>
            </div>



        </section>
    </div>




</main>